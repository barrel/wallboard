/*
wallboard - v - 2014-12-12
An app to make a dashboard for the wallboard.
Lovingly coded by BarrelNY Developers  - http://barrelny.com 
*/
!function(a){a.fn.marquee=function(b){function c(a,b,c){var d=c.behavior,e=c.width,f=c.dir,g=0;return g="alternate"==d?1==a?b[c.widthAxis]-2*e:e:"slide"==d?-1==a?-1==f?b[c.widthAxis]:e:-1==f?b[c.widthAxis]-2*e:0:-1==a?b[c.widthAxis]:0}function d(){for(var b=e.length,f=null,g=null,h={},i=[],j=!1;b--;)f=e[b],g=a(f),h=g.data("marqueeState"),g.data("paused")!==!0?(f[h.axis]+=h.scrollamount*h.dir,j=-1==h.dir?f[h.axis]<=c(-1*h.dir,f,h):f[h.axis]>=c(-1*h.dir,f,h),"scroll"==h.behavior&&h.last==f[h.axis]||"alternate"==h.behavior&&j&&-1!=h.last||"slide"==h.behavior&&j&&-1!=h.last?("alternate"==h.behavior&&(h.dir*=-1),h.last=-1,g.trigger("stop"),h.loops--,0===h.loops?(f[h.axis]="slide"!=h.behavior?c(h.dir,f,h):c(-1*h.dir,f,h),g.trigger("end")):(i.push(f),g.trigger("start"),f[h.axis]=c(h.dir,f,h))):i.push(f),h.last=f[h.axis],g.data("marqueeState",h)):i.push(f);e=i,e.length&&setTimeout(d,25)}var e=[],f=this.length;return this.each(function(g){var h=a(this),i=h[0].tagName,j="marquee"===i?"div":i,k=h.attr("width")||h.width(),l=h.attr("height")||h.height(),m=h.after("<"+j+" "+(b?'class="'+b+'" ':"")+'style="display: block-inline; width: '+k+"px; height: "+l+'px; overflow: hidden;"><div style="float: left; white-space: nowrap;">'+h.html()+"</"+j+"></div>").next(),n=m.get(0),o=(h.attr("direction")||"left").toLowerCase(),p={dir:/down|right/.test(o)?-1:1,axis:/left|right/.test(o)?"scrollLeft":"scrollTop",widthAxis:/left|right/.test(o)?"scrollWidth":"scrollHeight",last:-1,loops:h.attr("loop")||-1,scrollamount:h.attr("scrollamount")||this.scrollAmount||2,behavior:(h.attr("behavior")||"scroll").toLowerCase(),width:/left|right/.test(o)?k:l};-1==h.attr("loop")&&"slide"==p.behavior&&(p.loops=1),h.remove(),/left|right/.test(o)?m.find("> div").css("padding","0 "+k+"px"):m.find("> div").css("padding",l+"px 0"),m.bind("stop",function(){m.data("paused",!0)}).bind("pause",function(){m.data("paused",!0)}).bind("start",function(){m.data("paused",!1)}).bind("unpause",function(){m.data("paused",!1)}).data("marqueeState",p),e.push(n),n[p.axis]=c(p.dir,n,p),m.trigger("start"),g+1==f&&d()}),a(e)}}(jQuery),google.load("feeds","1");var wallboard={init:function(){this.update_weather(),this.update_ticker(newsfeed),this.photo_slider(),this.weather=window.setInterval(wallboard.update_weather,6e4),this.time=window.setInterval(wallboard.update_time,3e4)},update_ticker:function(a){$(".news-slider").empty();var b=new google.feeds.Feed(a);b.load(function(a){if(!a.error){for(var b=0;b<a.feed.entries.length;b++){var c=a.feed.entries[b],d=new Date(c.publishedDate),e=d.getHours(),f="am";if(!(c.title.length<1)){e>12&&(e-=12,f="pm");var g=("0"+d.getMinutes()).slice(-2);$(".news-slider").append("<li><p>"+c.title+'<span class="news-time">'+e+":"+g+" "+f+"</span></p></li>")}}$(".news-slider").marquee({ticker:!0,speed:1e5})}})},update_time:function(){var a=new Date,b=a.getHours(),c="a";b>12&&(b-=12,c="p");var d=("0"+a.getMinutes()).slice(-2);$(".time").html(b+":"+d+' <span class="meridiem">'+c+"</span>")},update_weather:function(){$.ajax({url:siteUrl+"inc/ajax/weather.php",type:"GET"}).done(function(a){weather=JSON.parse(a),$(".now-icon").html(weather.now_icon),$(".now-temp").html(weather.now_temperature+"<sup>&deg;</sup>"),$(".now-low").html(weather.now_low+"<sup>&deg;</sup>"),$(".now-high").html(weather.now_high+"<sup>&deg;</sup>"),$(".next-hour").html(weather.next_hour_icon+weather.next_hour_temperature+"<sup>&deg;</sup>"),$(".tomorrow").html(weather.tomorrow_icon+weather.tomorrow_temperature+"<sup>&deg;</sup>"),$(".two-days").html(weather.next_icon+weather.next_temperature+"<sup>&deg;</sup>"),$(".updated-datetime").html("Last updated:"+weather.date)})},photo_slider:function(){wallboard.images=document.getElementById("slideshow").getElementsByTagName("img"),wallboard.numberOfImages=wallboard.images.length,wallboard.i=1,document.getElementById("slideshow").getElementsByTagName("img")[0].className="fx",window.setInterval(wallboard.kenburns,5e3)},kenburns:function(){wallboard.i==wallboard.numberOfImages&&(wallboard.i=0),wallboard.images[wallboard.i].className="fx",0===wallboard.i&&(wallboard.images[wallboard.numberOfImages-2].className=""),1===wallboard.i&&(wallboard.images[wallboard.numberOfImages-1].className=""),wallboard.i>1&&(wallboard.images[wallboard.i-2].className=""),wallboard.i++}};$(function(){wallboard.init()});