/*
wallboard - v - 2015-01-13
An app to make a dashboard for the wallboard.
Lovingly coded by BarrelNY Developers  - http://barrelny.com 
*/
var wallboard={init:function(){var a=this;a.firstUpdate=!0,a.update_time(),a.update_weather(),a.photo_slider(),a.instagram_module(),a.time=window.setInterval(wallboard.update_time,3e4)},update_time:function(){var a=new Date,b=a.getHours(),c=b>12?"p":"a",d=("0"+a.getMinutes()).slice(-2),e=document.querySelectorAll(".time");if(b>=10&&18>=b&&(parseInt(d)%15===0||wallboard.firstUpdate)){wallboard.firstUpdate=!1,current=2*(b-10),parseInt(d)>30&&(current+=1);var f=document.querySelectorAll(".current-mark");f[0].style.height=40*current-1+"px";for(var g=document.querySelectorAll(".e-time"),h=0;h<g.length;h++){var i=g[h].innerHTML.split("-").pop().split(":"),j=parseInt(i[0])+(i[1].indexOf("pm")>-1?12:0),k=(parseInt(i[1]),g[h].parentNode.className),l=k.indexOf("top")>-1,m=j>b?k+(l?"":" top"):k.replace("top","");g[h].parentNode.className=m}}b>12&&(b-=12,c="p"),e[0].innerHTML=b+":"+d+' <span class="meridiem">'+c+"</span>"},update_weather:function(){var a=document,b=this,c=siteUrl+"inc/ajax/weather.php",d=new XMLHttpRequest;d.onreadystatechange=function(){if(4==d.readyState){var e=JSON.parse(d.responseText);a.querySelectorAll(".now-icon")[0].innerHTML=e.now_icon,a.querySelectorAll(".now-temp")[0].innerHTML=e.now_temperature+"<sup>&deg;</sup>",a.querySelectorAll(".now-low")[0].innerHTML=e.now_low+"<sup>&deg;</sup>",a.querySelectorAll(".now-high")[0].innerHTML=e.now_high+"<sup>&deg;</sup>",a.querySelectorAll(".next-hour")[0].innerHTML=e.next_hour_icon+e.next_hour_temperature+"<sup>&deg;</sup>",a.querySelectorAll(".tomorrow")[0].innerHTML=e.tomorrow_icon+e.tomorrow_temperature+"<sup>&deg;</sup>",a.querySelectorAll(".two-days")[0].innerHTML=e.next_icon+e.next_temperature+"<sup>&deg;</sup>",a.querySelectorAll(".updated-datetime")[0].innerHTML="Last updated: "+e.date,b.weather=window.setTimeout(function(){delete a,delete c,delete d,delete e,clearTimeout(b.weather),b.update_weather()},9e5)}},d.open("GET",c,!0),d.send()},instagram_module:function(){wallboard.instagram=this.setPhotoInfo("instagram"),wallboard.instagram&&(wallboard.layout(),window.setInterval(wallboard.layout,1e4))},photo_slider:function(){var a=this.setPhotoInfo("slideshow");a&&(wallboard.images[0].className="fx",window.setInterval(wallboard.kenburns,5e3))},setPhotoInfo:function(a){var b=document.getElementById(a);return null===b?!1:(wallboard.images=b.getElementsByTagName("img"),wallboard.numberOfImages=wallboard.images.length,wallboard.i=1,b)},layout:function(){var a=(manifest.data,wallboard.instagram),b=a.getElementsByTagName("span"),c=Math.floor(6*Math.random()),d=b[c],e=d.getElementsByTagName("img")[0],f=manifest.data.splice(Math.floor(Math.random()*manifest.data.length),1,e.src),f=f[0],g=new Image;g.src=f,d.style.backgroundImage='url("'+f+'")',d.className="cross",setTimeout(function(){e.remove(),d.appendChild(g),d.style.backgroundImage="",d.className=""},5e3)},kenburns:function(){wallboard.i==wallboard.numberOfImages&&(wallboard.i=0),wallboard.images[wallboard.i].className="fx",0===wallboard.i&&(wallboard.images[wallboard.numberOfImages-2].className=""),1===wallboard.i&&(wallboard.images[wallboard.numberOfImages-1].className=""),wallboard.i>1&&(wallboard.images[wallboard.i-2].className=""),wallboard.i++}};